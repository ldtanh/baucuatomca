<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>B·∫ßu Cua H·ªì L√¥ ƒê·ªè - CRYPTO RANDOM</title>
    <style>
        :root { --red: #d90429; --gold: #ef233c; --dark: #2b2d42; }
        body { background: #1a1a1d; color: white; font-family: sans-serif; text-align: center; }
        .dice-stage { display: flex; justify-content: center; gap: 20px; height: 150px; margin: 20px; }
        .dice { 
            width: 80px; height: 80px; background: white; border-radius: 15px;
            display: flex; align-items: center; justify-content: center; font-size: 50px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5); opacity: 0;
        }
        .dropping { animation: drop 0.7s cubic-bezier(0.2, 0.8, 0.2, 1) forwards; }
        @keyframes drop {
            0% { transform: translateY(-400px) rotate(0deg); opacity: 0; }
            100% { transform: translateY(0) rotate(720deg); opacity: 1; }
        }
        .board { display: grid; grid-template-columns: repeat(3, 1fr); max-width: 500px; margin: auto; gap: 10px; }
        .slot { background: #3d3d40; padding: 15px; border-radius: 10px; cursor: pointer; border: 2px solid transparent; }
        .slot:hover { border-color: gold; }
        .holo { color: red; font-weight: bold; }
        button { background: gold; padding: 15px 40px; font-weight: bold; border-radius: 30px; cursor: pointer; margin: 20px; border: none; }
        button:disabled { background: #555; }
        #balance { color: #00ff00; font-size: 1.5em; }
    </style>
</head>
<body>

    <h1>B·∫¶U CUA CRYPTO-RANDOM</h1>
    <div id="balance">V·ªën ·∫£o: 100,000 VNƒê</div>

    <div class="dice-stage">
        <div class="dice" id="d1"></div>
        <div class="dice" id="d2"></div>
        <div class="dice" id="d3"></div>
    </div>

    <div class="board" id="board"></div>

    <button id="roll-btn" onclick="play()">ƒê·ªî X√ç NG·∫¶U</button>
    <div id="log" style="margin-top:20px; color:#aaa"></div>

<script>
    const items = [
        { name: "Nai", icon: "ü¶å" },
        { name: "B·∫ßu", icon: "üèÆ", isRed: true },
        { name: "G√†", icon: "üêî" },
        { name: "C√°", icon: "üêü" },
        { name: "Cua", icon: "ü¶Ä" },
        { name: "T√¥m", icon: "ü¶ê" }
    ];

    let wallet = 100000;
    let bets = [];

    function init() {
        const b = document.getElementById('board');
        b.innerHTML = items.map((item, i) => `
            <div class="slot" onclick="placeBet(${i})">
                <div style="font-size:40px" class="${item.isRed ? 'holo' : ''}">${item.isRed ? 'üèÆ' : item.icon}</div>
                <div>${item.name}</div>
                <div id="bet-${i}" style="color:gold">0</div>
            </div>
        `).join('');
    }

    function placeBet(i) {
        if (wallet < 10000) return alert("H·∫øt ti·ªÅn r·ªìi b·∫°n ∆°i!");
        wallet -= 10000;
        bets.push({ name: "B·∫°n", idx: i, amt: 10000 });
        updateUI();
    }

    function updateUI() {
        document.getElementById('balance').innerText = `V·ªën ·∫£o: ${wallet.toLocaleString()} VNƒê`;
        items.forEach((_, i) => {
            const sum = bets.filter(b => b.idx === i).reduce((a, b) => a + b.amt, 0);
            document.getElementById(`bet-${i}`).innerText = sum.toLocaleString();
        });
    }

    // THU·∫¨T TO√ÅN RANDOM TH·ª∞C TH·∫æ (D√πng Crypto API)
    function getSecureRandom() {
        const array = new Uint32Array(1);
        window.crypto.getRandomValues(array);
        return array[0] % 6; // L·∫•y d∆∞ cho 6 m·∫∑t
    }

    function play() {
        if (bets.length === 0) return alert("ƒê·∫∑t c∆∞·ª£c ƒë√£!");
        const btn = document.getElementById('roll-btn');
        btn.disabled = true;

        const diceEls = [document.getElementById('d1'), document.getElementById('d2'), document.getElementById('d3')];
        const results = [];

        diceEls.forEach((el, i) => {
            el.classList.remove('dropping');
            void el.offsetWidth;
            setTimeout(() => {
                const res = getSecureRandom();
                results.push(res);
                el.innerHTML = items[res].isRed ? '<span class="holo">üèÆ</span>' : items[res].icon;
                el.classList.add('dropping');
            }, i * 200);
        });

        setTimeout(() => {
            calculateMoney(results);
            btn.disabled = false;
        }, 1500);
    }

    function calculateMoney(results) {
        let winAmt = 0;
        let logMsg = "K·∫øt qu·∫£: " + results.map(r => items[r].name).join(" - ") + "<br>";

        bets.forEach(bet => {
            const matches = results.filter(r => r === bet.idx).length;
            if (matches > 0) {
                // Ti·ªÅn th·∫Øng = Ti·ªÅn g·ªëc + (Ti·ªÅn c∆∞·ª£c * s·ªë m·∫∑t xu·∫•t hi·ªán)
                const win = bet.amt + (bet.amt * matches);
                winAmt += win;
            }
        });

        wallet += winAmt;
        if (winAmt > 0) {
            logMsg += `<span style="color:lime">B·∫°n th·∫Øng ${winAmt.toLocaleString()}ƒë!</span>`;
        } else {
            logMsg += `<span style="color:red">B·∫°n thua s·∫°ch v√°n n√†y!</span>`;
        }

        document.getElementById('log').innerHTML = logMsg;
        bets = [];
        updateUI();
    }

    init();
</script>
</body>
</html>
